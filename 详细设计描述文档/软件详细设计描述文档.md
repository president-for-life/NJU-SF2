# 连锁商店管理系统（MSCS）软件详细设计描述文档

## 1. 引言

### 1.1 编制目的

本报告详细完成对连续商店管理系统的详细设计，达到指导后续...

### 1.2 词汇表

| 词汇名称 | 词汇含义 | 备注 |
| :-: | :-: | :-: |
| MSCS | 连锁商店管理系统 | …… |
| …… | …… | …… |

### 1.3 参考资料

## 2. 产品描述

参考连锁商店管理系统用例文档和...

## 3. 系统结构设计概述

参考连锁商店管理系统...

## 4. 结构视角

### 4.1 业务逻辑层的分解

业务逻辑层的开发包图参见软件体系结构文档图

#### 4.1.1 management模块

(1) 模块概述

...

(2) 整体结构

...

(3) 模块内部类的接口规范

...

(4) 业务逻辑层的动态模型

...

(5) 业务逻辑层的设计原理

...

#### 4.1.2 promotion模块

(1) 模块概述

promotion模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。
promotion模块的职责及接口参见软件系统结构描述文档表。

(2) 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加bl.promotion.ActivityService、bl.promotion.CouponService和bl.promotion.VIPService接口。业务逻辑层和数据层之间添加data.promotion.ActivityMapper、data.promotion.CouponMapper和data.promotion.VIPCardMapper接口。Activity、Coupon和VIPCard是作为持久化对象被添加到设计模型中去的。

图 promotion模块各个类的设计

promotion模块各个类的职责如表所示。

表 promotion模块各个类的职责

| 类                  | 职责 |
| ------------------- | ---- |
| ActivityServiceImpl | x    |
| CouponServiceImpl   | x    |
| VIPServiceImpl      | x    |

(3) 模块内部类的接口规范

ActivityServiceImpl、CouponServiceImpl和VIPServiceImpl的接口规范如表所示。

表 ActivityServiceImpl的接口规范

提供的服务（供接口）

<table>

<tr>
  <td rowspan="4">ActivityServiceImpl.publishActivity</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO publishActivity(ActivityForm activityForm)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

<tr>
  <td rowspan="4">ActivityServiceImpl.getActivities</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getActivities()</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

</table>

需要的服务（需接口）

<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>

<tr>
  <td>ActivityMapper.insertActivity(Activity activity)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr>
  <td>ActivityMapper.insertActivityAndMovie(int activityId, List<Integer> movieId)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr>
  <td>ActivityMapper.selectActivities()</td>
  <td>查找多个持久化对象</td>
</tr>

<tr>
  <td>ActivityMapper.selectActivitiesByMovie(int movieId)</td>
  <td>根据movieId进行查找多个持久化对象</td>
</tr>

<tr>
  <td>ActivityMapper.selectById(int id)</td>
  <td>根据id查找单一持久化对象</td>
</tr>

<tr>
  <td>ActivityMapper.selectActivitiesWithoutMovie()</td>
  <td>查找多个持久化对象</td>
</tr>

</table>

表 CouponServiceImpl的接口规范

提供的服务（供接口）

<table>

<tr>
  <td rowspan="4">CouponServiceImpl.getCouponsByUser(</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getCouponsByUser(int userId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

<tr>
  <td rowspan="4">CouponServiceImpl.addCoupon(</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO addCoupon(CouponForm couponForm)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

<tr>
  <td rowspan="4">CouponServiceImpl.issueCoupon(</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO issueCoupon(int couponId, int userId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

</table>

需要的服务（需接口）

<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>

<tr>
  <td>CouponMapper.insertCoupon(Coupon coupon)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr>
  <td>CouponMapper.selectCouponByUser(int userId)</td>
  <td>根据userId查找多个持久化对象</td>
</tr>

<tr>
  <td>CouponMapper.selectById(int id)</td>
  <td>根据id查找单一持久化对象</td>
</tr>

<tr>
  <td>CouponMapper.insertCouponUser(int couponId, int userId)</td>
  <td>根据couponId和userId查找单一持久化对象</td>
</tr>

<tr>
  <td>CouponMapper.deleteCouponUser(int couponId, int userId)</td>
  <td>根据couponId和userId删除单一持久化对象</td>
</tr>

<tr>
  <td>CouponMapper.selectCouponByUserAndAmount(int userId, double amount)</td>
  <td>根据userId和amount查找多个持久化对象</td>
</tr>

</table>

表 VIPServiceImpl的接口规范

提供的服务（供接口）

<table>

<tr>
  <td rowspan="4">VIPServiceImpl.addVIPCard</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO addVIPCard(int userId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

<tr>
  <td rowspan="4">VIPServiceImpl.getCardById</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getCardById(int id)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

<tr>
  <td rowspan="4">VIPServiceImpl.getVIPInfo</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getVIPInfo()</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

<tr>
  <td rowspan="4">VIPServiceImpl.charge</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO charge(VIPCardForm vipCardForm)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

<tr>
  <td rowspan="4">VIPServiceImpl.getCardByUserId</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getCardByUserId(int userId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td></td>
</tr>

</table>

需要的服务（需接口）

<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>

<tr>
  <td>VIPServiceImpl.insertOneCard(VIPCard vipCard)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr>
  <td>VIPServiceImpl.selectCardById(int id)</td>
  <td>根据id查找单一持久化对象</td>
</tr>

<tr>
  <td>VIPServiceImpl.updateCardBalance(int id, double balance)</td>
  <td>根据id和balance更新单一持久化对象</td>
</tr>

<tr>
  <td>VIPServiceImpl.selectCardByUserId(int userId)</td>
  <td>根据userId查找单一持久化对象</td>
</tr>

</table>

(4) 业务逻辑层的动态模型

...

(5) 业务逻辑层的设计原理

...

#### 4.1.3 sales模块

(1) 模块概述

...

(2) 整体结构

...

(3) 模块内部类的接口规范

...

(4) 业务逻辑层的动态模型

...

(5) 业务逻辑层的设计原理

...

#### 4.1.4 statistics模块

(1) 模块概述

statistics 模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

statistics模块的职责及接口参见软件系统结构描述文档表。

(2) 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。

statistics模块各个类的职责如表所示。

表statistic

| 类                   | 职责                                 |
| -------------------- | ------------------------------------ |
| MovieLikeServicelmpl | 负责实现把电影标记为想看所需要的服务 |
| StatisticServicelmpl |                                      |

模块各个类的职责

(3) 模块内部类的接口规范

表 MovieLikeServicelmpl的接口规范

提供的服务（供接口）

<table>

<tr>
  <td rowspan="4">MovieServiceImpl.likeMovie</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO likeMovie(int userId, int movieId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>该电影资料已存在，用户未标记为想看</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>保存一条想看记录</td>
</tr>

<tr>
  <td rowspan="4">MovieServiceImpl.unLikeMovie</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO unLikeMovie(int userId, int movieId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>该电影资料已存在，用户已标记为想看</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删去一条想看记录</td>
</tr>

<tr>
  <td rowspan="4">MovieServiceImpl.getCountOfLikes</td>
</tr>
<tr>

  <td>语法</td>
  <td>public ResponseVO getCountOfLikes(int movieId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回某个电影的想看人数</td>
</tr>

<tr>
  <td rowspan="4">MovieServiceImpl.getLikeNumsGroupByDate</td>
</tr>
<tr>

  <td>语法</td>
  <td>public ResponseVO getLikeNumsGroupByDate(int movieId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回某个电影的喜爱人数按日期统计</td>
</tr>

<tr>
  <td rowspan="4">MovieServiceImpl.userLikeTheMovie</td>
</tr>
<tr>

  <td>语法</td>
  <td>public ResponseVO userLikeTheMovie(int userId, int movieId)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回某个用户是否喜欢某个电影</td>
</tr>

  <td>语法</td>
  <td>public List<DateLikeVO>  dateLikeList2DateLikeVOList(int List<DateLike> dateLikeList)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回某段时间的各自的喜爱人数</td>
</tr>

</table>

需要的服务（需接口）

<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>

<tr>
  <td>MovieServiceForBl.getMovieById(int id)</td>
  <td>根据id查找单一持久化对象</td>
</tr>

<tr>
  <td>MovieLikeMapper.insertOneLike(int movieId,int userId)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr>
  <td>MovieLikeMapper.deleteOneLike(int movieId,int userId)</td>
  <td>删除单一持久化对象</td>
</tr>

<tr>
  <td>MovieLikeMapper.selectOneLike(int movieId)</td>
  <td>根据movieId查找单一持久化对象</td>
</tr>

<tr>
  <td>MovieLikeMapper.getDateLikeNum(int movieId)</td>
  <td>根据movieId查找多个持久化对象</td>
</tr>

<tr>
  <td>MovieLikeMapper.selectLikeMovie(int movieId,int userId)</td>
  <td>根据movieId和userId查找单一持久化对象</td>
</tr>

</table>

表 StatisticsServicelmpl的接口规范

提供的服务（供接口）

<table>

<tr>
  <td rowspan="4">StatisticsServicelmpl.getScheduleRateByDate</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getScheduleRateByDate(Date date)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取某日影片排片率统计数据</td>
</tr>

<tr>
  <td rowspan="4">StatisticsServicelmpl.getTotalBoxOffice</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getTotalBoxOffice()</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取所有电影的累计票房</td>
</tr>

<tr>
  <td rowspan="4">StatisticsServicelmpl.getAudiencePriceSevenDays</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getAudiencePriceSevenDays()</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取过去七天内每天的客单价</td>
</tr>

<tr>
  <td rowspan="4">StatisticsServicelmpl.getMoviePlacingRateByDate</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getMoviePlacingRateByDate(Date date)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取所有电影某天的上座率</td>
</tr>

<tr>
  <td rowspan="4">StatisticsServicelmpl.getPopularMovies</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResponseVO getPopularMovie(int days, int movieNum)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td></td>
</tr>
<tr>
  <td>后置条件</td>
  <td>获取最近某些天内，最受欢迎的某些电影</td>
</tr>

</table>

(4) 业务逻辑层的动态模型

...

(5) 业务逻辑层的设计原理

...

#### 4.1.5 user模块

(1) 模块概述

...

(2) 整体结构

...

(3) 模块内部类的接口规范

...

(4) 业务逻辑层的动态模型

...

(5) 业务逻辑层的设计原理

...

## 5. 依赖视角
