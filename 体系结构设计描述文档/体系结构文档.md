# 软件体系结构文档模板

## 文档修改历史

| 修改人员 | 日期       | 修改原因                     | 版本号 |
|:--------:| ---------- | ---------------------------- | ------ |
|  戴羽涵  | 2019.04.13 | 添加"5.2 用户界面层分解"内容 |        |
|  徐志乐  | 2019.04.14 | 修改"5.1 层间调用借口"服务调用方和服务提供方       |

## 目录



## 1. 引言

### 1.1 编制目的

	本报告详细完成对影院影片管理系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。
	本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航

### 1.2 词汇表

| 词汇名称 | 词汇含义 | 备注 |
| :------: | -------- | ---- |
|          |          |      |



### 1.3 参考资料

	软件开发的技术基础 软件工程与计算（卷二） —— 罗斌、丁二玉、刘钦

## 2. 产品概述

	参考连锁商店管理系统用例文档和连锁商店管理系统软件需求规格说明中对产品的概括描述。

## 3. 逻辑视图

- 处理静态设计模型

  - 影院影片管理系统中，选择了分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层）能够很好地示意整个高层抽象。展示层包含WEB页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如示意图所示。

- 示意图

  - 注意：逻辑表达需要更加细化



## 4. 组合视图

### 4.1 开发包图

- 表示软件组件在开发时环境中的静态组织
  - 描述开发包以及相互间的依赖
  - 绘制开发包图
    - 开发包图类似上述示意图画法

| 开发包 | 依赖的其他开发包               |
| :----: | ------------------------------ |
| mainui | userui、manageui、vo、clientui |
|        |                                |



### 4.2 运行时进程

- 表示软件在运行时进程间的交互，描述系统的动态结构

  - 绘制进程图

- 示意图：


### 4.3 物理部署

- 处理如何将软件组件映射到硬件基础设施
  - 绘制部署图
- 示意图

![icon](http://assets.processon.com/chart_image/5ae5be27e4b039625af793c0.png?_=1554259679134)

## 4.4 架构设计

- 描述功能分解和如何在不同的层中安排软件模块
  - 描述架构中的对象，包含架构图
  - 描述组件接口信息
    - 包括：语法、前置条件、后置条件

## 5. 接口视角

### 5.1 模块职责

- 模块视图
- 各层职责

|  层        | 职责     |
| :--------: | -------- |
| 用户界面层 | 展示界面 |
| 业务逻辑层 | 对于用户界面的输入进行响应并进行业务处理逻辑 |
| 数据层     | 负责数据的持久化及数据访问接口 |

- 层之间调用接口

| 接口 | 服务调用方       | 服务提供方          |
| :--: | ---------------- | ------------------- |
| UserBLService           | 展示层 | 业务逻辑层 |
| ManagerBLService        | 展示层 | 业务逻辑层 |
| ManagementBLService     | 展示层 | 业务逻辑层 |
| LikeBLService           | 展示层 | 业务逻辑层 |
| MovieDetailsBLService   | 展示层 | 业务逻辑层 |
| UserDataService         | 业务逻辑层 | 数据层 |
| ManagerDataService      | 业务逻辑层 | 数据层 |
| ManagementDataService   | 业务逻辑层 | 数据层 |
| LikeBLService           | 业务逻辑层 | 数据层 |
| MovieDetailsDataService | 业务逻辑层 | 数据层 |


### 5.2 用户界面层分解

根据需求，系统存在25个用户界面：登录界面、注册界面、管理员主界面、观众主界面、影院员工主界面、电影上架界面、电影下架界面、统计电影想看人数界面、查看电影列表界面、电影详情界面界面、查看电影票界面、查看排片信息界面、搜索电影界面、会员卡界面、购买会员卡界面、查看会员卡界面、充值会员卡界面、购买电影票界面、电影排片界面、添加排片信息界面、修改排片信息界面、删除排片信息界面、查看排片信息界面、查看统计数据界面、发布优惠活动界面。界面跳转如下图所示。

![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%B1%82%E7%9A%84%E5%88%86%E8%A7%A3-%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E8%B7%B3%E8%BD%AC.jpg?raw=true)

用户界面类如下图所示。
![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%B1%82%E7%9A%84%E5%88%86%E8%A7%A3-%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E7%B1%BB.png?raw=true)

#### 5.2.1 职责

用户界面层模块的职责如下表所示。

| 模块           | 职责                                                   |
| -------------- | ------------------------------------------------------ |
| MainFrame      | 界面Frame，负责界面的显示和界面的跳转                  |
| userui         | 负责实现用户注册、登录界面的显示                       |
| moviedetailsui | 负责实现电影上架、电影列表查看、电影详情查看界面的显示 |
| likeui         | 负责实现电影标记、电影想看人数统计界面的显示           |
| scheduleui     | 负责实现排片界面的显示                                 |
| promotionui    | 负责实现优惠活动发布界面的显示                         |
| salesui        | 负责实现电影票购买、统计数据查看界面的显示             |
| memberui       | 负责实现会员卡购买、会员卡查看、会员卡充值界面的显示   |




#### 5.2.2 接口规范

用户界面层模块的接口规范如下表所示。

<table>
<tr>
  <td rowspan="4">MainFrame</td>
</tr>

<tr>
  <td>语法</td>
  <td>init(args:String[])</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>显式Frame以及LoginPanel</td>
</tr>

</table>

用户界面层需要的服务接口如下表所示。

| 服务名                                     | 服务                                                   |
| ------------------------------------------ | ------------------------------------------------------ |
| businesslogicservice.userblservice         | 观众、管理员、影院员工登录、注册界面的业务逻辑接口     |
| businesslogicservice.moviedetailsblservice | 电影上架、电影列表查看、电影详情查看界面的业务逻辑接口 |
| businesslogicservice.likeblservice         | 电影标记、电影想看人数统计界面的业务逻辑接口           |
| businesslogicservice.scheduleblservice     | 排片界面的业务逻辑接口                                 |
| businesslogicservice.promotionblservice    | 优惠活动发布界面的业务逻辑接口                         |
| businesslogicservice.salesblservice        | 电影票购买、统计数据查看界面的业务逻辑接口             |
| businesslogicservice.memberblservice       | 会员卡购买、会员卡查看、会员卡充值界面的业务逻辑接口                                                       |

#### 5.2.3 设计原理

用户界面利用JavaScript、CSS、HTML来实现。

### 5.3 业务逻辑层分解

#### 5.3.1 职责

| 模块           | 职责                                                 |
| -------------- | :--------------------------------------------------- |
| userbl         | 负责实现用户注册、登陆界面所需要的服务               |
| hallbl      | 负责影厅管理 |
| moviedetailsbl   | 负责实现管理电影上架、下架和搜索、查看电影详情所需要的服务 |
| likebl         | 负责实现标记想看、统计预售电影的想看人数所需要的服务 |
| schedulebl | 负责排片所需要的服务  |
| promotionbl | 负责优惠所需要的服务  |
| salesbl | 负责销售所需要的服务  |
| memberbl | 负责会员所需要的服务  |

#### 5.3.2 接口规范

userbl模块的接口规范

hallbl模块的接口规范

moviedetailsbl模块的接口规范

likebl模块的接口规范

schedulebl模块的接口规范

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Schedule.seekFreeTime</td>
</tr>

<tr>
  <td>语法</td>
  <td>public  ResultMassage seekFreeTime(Date time,long hallID);</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>返回该日期下该影厅可供排片的时间段和影片列表</td>

</tr>

<tr>
  <td rowspan="4">Schedule.addMovie</td>
</tr>

<tr>
  <td>语法</td>
  <td>public boolean addMovie(Date time,long movieDetailsID，int money);</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>该时间为可供片时间</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>添加排片信息，返回是否添加成功</td>

</tr>

<tr>
  <td rowspan="4">Schedule.check</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage check(Date[] times,long[] ID，boolean hallVersion);</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>根据条件，返回排片信息，格式为“厅名，影片名，放映开始时间，放映结束时间，票价”</td>

</tr>

<tr>
  <td rowspan="4">Schedule.setVisibleTime</td>
</tr>

<tr>
  <td>语法</td>
  <td>public boolean setVisibleTime(Date[] time);</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>用户输入时间早于排片日期</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>设置某日期或日期区间排片信息对观众可见时间，并返回是否设置成功</td>

</tr>

<tr>
  <td rowspan="4">Schedule.updateVisibleTime</td>
</tr>

<tr>
  <td>语法</td>
  <td>public boolean updateVisibleTime(Date[] time);</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>用户输入时间早于排片日期</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>修改某日期或日期区间排片信息对观众可见时间，并返回是否设置成功</td>

</tr>

<tr>
  <td rowspan="4">Schedule.delectMovieSchedule</td>
</tr>

<tr>
  <td>语法</td>
  <td>public boolean delectMovieSchedule(Date[] time);</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>当前时间早于排片信息对观众可见时间</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>删除排片信息，并返回是否删除成功</td>

</tr>

<tr>
  <td rowspan="4">Schedule.delectMovieSchedule</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage updatetMovieSchedule(Date[] time);</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>当前时间早于排片信息对观众可见时间</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>修改该时间段的排片信息，并返回是否删除成功</td>

</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr>
  <td>ScheduleDataService.finds(Date[] time,long[] hallID)</td>
  <td>根据时间和影厅进行查找多个持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.insert(SchedulePO po)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.finds(Date[] time,long[] movieDetailsID)</td>
  <td>根据时间和电影进行查找多个持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.updates(SchedulePO po，Date time)</td>
  <td>更新多个持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.updates(Date[] time)</td>
  <td>更新某个时间段多个持久化对象</td>
</tr>

<tr>
  <td>DatabaseFacory.getScheduleDatabase</td>
  <td>得到scheduleDatabase数据库的服务引用</td>
</tr>

<tr>
  <td>ScheduleDataService.delect(Date[] time)</td>
  <td>根据时间删除该时间段的对象</td>
</tr>

</table>

promotionbl模块的接口规

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Promotion.addPromotion</td>
</tr>

<tr>
  <td>语法</td>
  <td>public void addPromotion(Date[] activeityTime,Date[] validTime,int money,String condition)</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>添加优惠政策</td>
</tr>

<tr>
  <td rowspan="4">Promotion.comparePromotion</td>
</tr>

<tr>
  <td>语法</td>
  <td>public boolean comparePromotion(Date[] activeityTime,Date[] validTime,int money,String condition)</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>跟优惠政策比较，返回是否满足优惠条件</td>
</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr> DatabaseFacory.getPromotionDatabase</td>
  <td>得到PromotionDatabase数据库的服务引用</td>
</tr>

<tr>PromotionDataService.insert(PromotionPO po) </td>
  <td>插入单一持久化对象</td>
</tr>

</table>

salesbl模块的接口规范

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Sales.checkData</td>
</tr>

<tr>
  <td>语法</td>
  <td>public double checkData(String type)</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>返回该类统计数据对应的数据</td>
</tr>

<tr>
  <td rowspan="4">Sales.buyTicket</td>
</tr>

<tr>
  <td>语法</td>
  <td>public  boolean buyTicket(String[][]  seat,String  typePayment)</td>

</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>购票，返回是否成功</td>
</tr>

<tr>
  <td rowspan="4">Sales.checkTicket</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage checkTicket(）</td>

</tr>

<tr>
  <td>前置条件</td>
  <td>用户已购买电影票</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>返回已购电影票的详情</td>
</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr> DatabaseFacory.getSalesDatabase</td>
  <td>得到SalesDatabase数据库的服务引用</td>
</tr>

<tr> SalesDataService.find(int id)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>

<tr> SalesDataService.find(int userID)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>

<tr> SalesDataService.insert(SalesPO po)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr> SalesDataService.delect(SalesPO po)</td>
  <td>删除单一持久化对象</td>
</tr>

<tr> SalesDataService.update(SalesPO po)</td>
  <td>更新单一持久化对象</td>
</tr>

</table>

memberbl模块的接口规范

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Member.buy</td>
</tr>

<tr>
  <td>语法</td>
  <td>public void buy(String payment，String password )</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>购买会员卡</td>
</tr>

<tr>
  <td rowspan="4">Member.checkBalance</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage checkBalance(long id )</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>显示该用户的会员信息，包括会员卡余额等</td>
</tr>

<tr>
  <td rowspan="4">Member.recharge</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage recharge(String type，String password，int money )</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>充值完成</td>
</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr> DatabaseFacory.getMemberDatabase</td>
  <td>得到MemberDatabase数据库的服务引用</td>
</tr>

<tr> MemberDataService.insert(MemberPO po)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr> MemberDataService.find(long id)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>

<tr> MemberDataService.update(MemberPO po)</td>
  <td>更新单一持久化对象</td>
</tr>

</table>


### 5.4 数据层分解

#### 5.4.1 职责

| 模块           | 职责                                                 |
| -------------- | :--------------------------------------------------- |
| MovieDataService                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | 持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务               |
| MovieDataServiceTxtFileImpl| 基于Txt文件的持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务             |
| MovieDataServiceSerializableFileImpl   | 基于序列化文件的持续化数据库的借口、提供集体载入、集体保存、增、删、改、查服务|
| MovieDataServiceMySqlImpl | 基于MySql数据库的持续化数据库的借口，提供集体载入、集体保存、增、删、改、查服务|

#### 5.4.2 接口规范



### 6. 信息视角

- 描述数据持久化对象(PO)
  - 属性及其定义
  -
  - 类型
