# 软件体系结构文档模板

## 文档修改历史

| 修改人员 | 日期       | 修改原因                                     | 版本号 |
| :------: | ---------- | -------------------------------------------- | ------ |
|  戴羽涵  | 2019.04.13 | 添加"5.2 用户界面层分解"内容                 |        |
|  徐志乐  | 2019.04.14 | 修改"5.1 层间调用借口"服务调用方和服务提供方 |        |
|  梁正川  | 2019.04.19 | 添加"5.3 业务逻辑层分解"前四个模块的内容     |        |
|  石創烽  | 2019.04.19 | 添加“5.3 业务逻辑层分解”后四个模块的内容     |        |

## 目录



## 1. 引言

### 1.1 编制目的

	本报告详细完成对影院影片管理系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。
	本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

### 1.2 词汇表

| 词汇名称 | 词汇含义 | 备注 |
| :------: | -------- | ---- |
|          |          |      |



### 1.3 参考资料

	软件开发的技术基础 软件工程与计算（卷二） —— 罗斌、丁二玉、刘钦

## 2. 产品概述

	参考影院影片管理系统用例文档和影院影片管理系统软件需求规格说明中对产品的概括描述。

## 3. 逻辑视图

	影院影片管理系统中，选择了分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层）能够很好地示意整个高层抽象。展示层包含WEB页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如示意图所示。

	![icon]()
	参照体系结构风格的包图表达逻辑视角

	![icon]()
	软件体系结构逻辑设计方案



## 4. 组合视图

### 4.1 开发包图

影院影片管理系统的最终开发包设计如下表所示。

|         开发包          | 依赖的其他开发包                                                               |
|:-----------------------:| ------------------------------------------------------------------------------ |
|         mainui          | userui、moviedetailsui、likeui、scheduleui、promotionui、salesui、memberui、vo |
|         userui          | userblservice、vo                                                              |
|      userblservice      | vo                                                                             |
|         userbl          | userblservice、userdataservice、po                                             |
|        userdata         | userdataservice、databaseutility                                               |
|     userdataservice     | po                                                                             |
|     moviedetailsui      | moviedetailsblservice、vo                                                      |
|  moviedetailsblservice  | vo                                                                             |
|      movidetailsbl      | moviedetailsblservice、moviedetailsdataservice、salesbl、po                    |
|    moviedetailsdata     | moviedetailsdataservice、databaseutility                                       |
| moviedetailsdataservice | po                                                                             |
|         likeui          | likeblservice、vo                                                              |
|      likeblservice      | vo                                                                             |
|         likebl          | likeblservice、moviedetailsbl、likedataservice、po                             |
|        likedata         | likedataservice、databaseutility                                               |
|     likedataservice     | po                                                                             |
|       scheduleui        | scheduleblservice、vo                                                          |
|    scheduleblservice    | vo                                                                             |
|       schedulebl        | scheduleblservice、scheduledataservice、hallbl、po                             |
|      scheduledata       | scheduledataservice、databaseutility                                           |
|   scheduledataservice   | po                                                                             |
|       promotionui       | promotionservice、vo                                                           |
|   promotionblservice    | vo                                                                             |
|       promotionbl       | promotionblservice、promotiondataservice、userbl、moviedetailsbl、salesbl、po  |
|      promotiondata      | promotiondataservice、databaseutility                                          |
|  promotiondataservice   | po                                                                             |
|         salesui         | salesblservice、vo                                                             |
|     salesblservice      | vo                                                                             |
|         salesbl         | salesblservice、salesdataservice、userbl、schedulebl、memberbl、po             |
|        salesdata        | salesdataservice、databaseutility                                              |
|    salesdataservice     | po                                                                             |
|        memberui         | memberblservice、vo                                                            |
|     memberblservice     | vo                                                                             |
|        memberbl         | memberblservice、memberdataservice、po                                         |
|       memberdata        | memberdataservice、databaseutility                                             |
|    memberdataservice    | po                                                                             |
|         hallbl          | halldataservice、po                                                            |
|        halldata         | halldataservice、databaseutility                                               |
|     halldataservice     | po                                                                             |
|           vo            |                                                                                |
|           po            |                                                                                |
|     databaseutility     | JDBC                                                                           |



### 4.2 运行时进程

- 表示软件在运行时进程间的交互，描述系统的动态结构

  - 绘制进程图

- 示意图：


### 4.3 物理部署

- 处理如何将软件组件映射到硬件基础设施
  - 绘制部署图
- 示意图

![icon](http://assets.processon.com/chart_image/5ae5be27e4b039625af793c0.png?_=1554259679134)

## 4.4 架构设计

- 描述功能分解和如何在不同的层中安排软件模块
  - 描述架构中的对象，包含架构图
  - 描述组件接口信息
    - 包括：语法、前置条件、后置条件

## 5. 接口视角

### 5.1 模块职责

- 模块视图

![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E6%A8%A1%E5%9D%97%E8%A7%86%E5%9B%BE.jpg?raw=true)


- 各层职责

|  层        | 职责     |
| :--------: | -------- |
| 启动模块 | 启动用户界面 |
| 用户界面层 | 展示用户界面 |
| 业务逻辑层 | 对于用户界面的输入进行响应并进行业务处理逻辑 |
| 数据层     | 负责数据的持久化及数据访问接口 |

- 层之间调用接口

| 接口 | 服务调用方       | 服务提供方          |
| :--: | ---------------- | ------------------- |
| UserBLService           | 展示层 | 业务逻辑层 |
| MovieDetailsBLService        | 展示层 | 业务逻辑层 |
| LikeBLService     | 展示层 | 业务逻辑层 |
| ScheduleBLService           | 展示层 | 业务逻辑层 |
| PromotionBLService   | 展示层 | 业务逻辑层 |
| SalesBLService   | 展示层 | 业务逻辑层 |
| MemberBLService   | 展示层 | 业务逻辑层 |
| UserDataService         | 业务逻辑层 | 数据层 |
| HallDataService   | 业务逻辑层 | 数据层 |
| MovieDetailsDataService | 业务逻辑层 | 数据层 |
| LikeDataService           | 业务逻辑层 | 数据层 |
| ScheduleDataService      | 业务逻辑层 | 数据层 |
| PromotionDataDataService   | 业务逻辑层 | 数据层 |
| SalesDataDataService   | 业务逻辑层 | 数据层 |
| MemberDataDataService   | 业务逻辑层 | 数据层 |

### 5.2 用户界面层分解

根据需求，系统存在25个用户界面：登录界面、注册界面、管理员主界面、观众主界面、影院员工主界面、电影上架界面、电影下架界面、统计电影想看人数界面、查看电影列表界面、电影详情界面界面、查看电影票界面、查看排片信息界面、搜索电影界面、会员卡界面、购买会员卡界面、查看会员卡界面、充值会员卡界面、购买电影票界面、电影排片界面、添加排片信息界面、修改排片信息界面、删除排片信息界面、查看排片信息界面、查看统计数据界面、发布优惠活动界面。界面跳转如下图所示。

![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%B1%82%E7%9A%84%E5%88%86%E8%A7%A3-%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E8%B7%B3%E8%BD%AC.jpg?raw=true)

用户界面类如下图所示。
![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%B1%82%E7%9A%84%E5%88%86%E8%A7%A3-%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E7%B1%BB.png?raw=true)

#### 5.2.1 职责

用户界面层模块的职责如下表所示。

| 模块           | 职责                                                   |
| -------------- | ------------------------------------------------------ |
| MainFrame      | 界面Frame，负责界面的显示和界面的跳转                  |
| userui         | 负责实现用户注册、登录界面的显示                       |
| moviedetailsui | 负责实现电影上架、电影列表查看、电影详情查看界面的显示 |
| likeui         | 负责实现电影标记、电影想看人数统计界面的显示           |
| scheduleui     | 负责实现排片界面的显示                                 |
| promotionui    | 负责实现优惠活动发布界面的显示                         |
| salesui        | 负责实现电影票购买、统计数据查看界面的显示             |
| memberui       | 负责实现会员卡购买、会员卡查看、会员卡充值界面的显示   |




#### 5.2.2 接口规范

用户界面层模块的接口规范如下表所示。

<table>
<tr>
  <td rowspan="4">MainFrame</td>
</tr>

<tr>
  <td>语法</td>
  <td>init(args:String[])</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>显式Frame以及LoginPanel</td>
</tr>

</table>

用户界面层需要的服务接口如下表所示。

| 服务名                                     | 服务                                                   |
| ------------------------------------------ | ------------------------------------------------------ |
| businesslogicservice.userblservice         | 观众、管理员、影院员工登录、注册界面的业务逻辑接口     |
| businesslogicservice.moviedetailsblservice | 电影上架、电影列表查看、电影详情查看界面的业务逻辑接口 |
| businesslogicservice.likeblservice         | 电影标记、电影想看人数统计界面的业务逻辑接口           |
| businesslogicservice.scheduleblservice     | 排片界面的业务逻辑接口                                 |
| businesslogicservice.promotionblservice    | 优惠活动发布界面的业务逻辑接口                         |
| businesslogicservice.salesblservice        | 电影票购买、统计数据查看界面的业务逻辑接口             |
| businesslogicservice.memberblservice       | 会员卡购买、会员卡查看、会员卡充值界面的业务逻辑接口   |

#### 5.2.3 设计原理

用户界面利用JavaScript、CSS、HTML来实现。

### 5.3 业务逻辑层分解

#### 5.3.1 职责

| 模块           | 职责                                                         |
| -------------- | :----------------------------------------------------------- |
| userbl         | 负责实现用户注册、登陆界面所需要的服务                       |
| hallbl         | 负责实现影厅管理界面所需要的服务                             |
| moviedetailsbl | 负责实现管理电影上架下架和搜索并查看电影详情界面所需要的服务 |
| likebl         | 负责实现标记想看、统计预售电影的想看人数界面所需要的服务     |
| schedulebl     | 负责实现排片界面所需要的服务                                 |
| promotionbl    | 负责实现发布和使用优惠活动界面所需要的服务                   |
| salesbl        | 负责实现购买和查看电影票、查看统计数据界面所需要的服务       |
| memberbl       | 负责实现购买、查看、充值会员卡界面所需要的服务               |

#### 5.3.2 接口规范

##### 5.3.2.1 userbl模块的接口规范

提供的服务（供接口）
<table>

<tr>
  <td rowspan="4">User.login</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResultMessage login(String username, String password)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>查找是否存在相应的用户，根据输入的password返回登陆验证的结果（用户名是否存在/密码是否正确/该用户的身份）</td>
</tr>

<tr>
  <td rowspan="4">User.register</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResultMessage register(String username, String password)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>查找是否已经存在同样的用户名，根据输入的用户名和password返回注册的结果（相同的用户名是否存在/注册是否成功）</td>
</tr>

</table>

需要的服务（需接口）
<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>
<tr>
  <td>DatabaseFacory.getUserDatabase</td>
  <td>得到User数据库的服务的引用</td>
</tr>
<tr>
  <td>UserDataService.find(long userID)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>
<tr>
  <td>UserDataService.find(String username)</td>
  <td>根据username值进行查找单一持久化对象</td>
</tr>
<tr>
  <td>UserDataService.insert(UserPO po)</td>
  <td>插入单一持久化对象</td>
</tr>

</table>

##### 5.3.2.2 hallbl模块的接口规范

提供的服务（供接口）
<table>

<tr>
  <td rowspan="4">Hall.allHallList()</td>
</tr>
<tr>
  <td>语法</td>
  <td>public long[] allHallList()</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>查找并返回包含所有影厅ID的数组</td>
</tr>

<tr>
  <td rowspan="4">Hall.capacity(long hallID)</td>
</tr>
<tr>
  <td>语法</td>
  <td>public int capacity(long hallID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的影厅</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>查找并返回影厅的座位数</td>
</tr>

<tr>
  <td rowspan="4">Hall.seat(long hallID)</td>
</tr>
<tr>
  <td>语法</td>
  <td>public int[] capacity(long hallID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的影厅</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回影厅座位分布</td>
</tr>

</table>

需要的服务（需接口）
<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>
<tr>
  <td>DatabaseFacory.getHallDatabase</td>
  <td>得到Hall数据库的服务的引用</td>
</tr>
<tr>
  <td>HallDataService.findAll()</td>
  <td>查找所有持久化对象</td>
</tr>
<tr>
  <td>HallDataService.find(long hallID)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>

</table>

##### 5.3.2.3 moviedetailsbl模块的接口规范

提供的服务（供接口）
<table>

<tr>
  <td rowspan="4">MovieDetails.allMovieList</td>
</tr>
<tr>
  <td>语法</td>
  <td>public long[] allMovieList()</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>查找并返回包含所有已上架电影ID的数组</td>
</tr>

<tr>
  <td rowspan="4">MovieDetails.details</td>
</tr>
<tr>
  <td>语法</td>
  <td>public String[] details(long movieDetailsID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在该ID对应的电影</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回该电影的详情</td>
</tr>

<tr>
  <td rowspan="4">MovieDetails.searchMovie</td>
</tr>
<tr>
  <td>语法</td>
  <td>public long[] searchMovie(String keyword)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>keyword不为空</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回所有含有关键字的电影的ID数组</td>
</tr>

<tr>
  <td rowspan="4">MovieDetails.addMovie</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResultMessage addMovie(String[] details)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回上架电影的结果（是否上架成功）</td>
</tr>

<tr>
  <td rowspan="4">MovieDetails.hasScheduleOrSales</td>
</tr>
<tr>
  <td>语法</td>
  <td>public boolean hasScheduleOrSales(long movieDetailsID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在该ID对应的电影</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回电影是否已经有排片或已经有观众买票</td>
</tr>

<tr>
  <td rowspan="4">MovieDetails.removeMovie</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void removeMovie(long movieDetailsID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在该ID对应的电影且电影没有排片且没有观众买票</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>下架电影</td>
</tr>

<tr>
  <td rowspan="4">MovieDetails.modifyMovie</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void modifyMovie(long movieDetailsID, String[] details)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在该ID对应的电影且电影没有排片且没有观众买票</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>根据用户填写的修改信息修改电影信息</td>
</tr>

</table>

需要的服务（需接口）
<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>
<tr>
  <td>DatabaseFacory.getMovieDetailsDatabase</td>
  <td>得到MovieDetails数据库的服务的引用</td>
</tr>
<tr>
  <td>MovieDetailsDataService.findAll()</td>
  <td>查找所有持久化对象</td>
</tr>
<tr>
  <td>MovieDetailsDataService.find(long movieDetailsID)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>
<tr>
  <td>MovieDetailsDataService.find(String keyword)</td>
  <td>根据keyword进行查找多个持久化对象</td>
</tr>
<tr>
  <td>MovieDetailsDataService.insert(MovieDetailsPO po)</td>
  <td>插入单一持久化对象</td>
</tr>
<tr>
  <td>MovieDetailsDataService.delete(MovieDetailsPO po)</td>
  <td>删除单一持久化对象</td>
</tr>
<tr>
  <td>MovieDetailsDataService.update(MovieDetailsPO po)</td>
  <td>更新单一持久化对象</td>
</tr>

</table>

##### 5.3.2.4 likebl模块的接口规范

提供的服务（供接口）
<table>

<tr>
  <td rowspan="4">Like.isLike</td>
</tr>
<tr>
  <td>语法</td>
  <td>public boolean isLike(long userID, long movieDetailsID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的用户和电影</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回该用户是否想看该电影</td>
</tr>

<tr>
  <td rowspan="4">Like.addLike</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void changeLike(long userID, long movieDetailsID, Date date)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的用户和电影</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>如果用户之前没有想看该电影，增加用户在某时间想看电影的数据；如果用户之前想看该电影，移除用户在某时间想看电影的数据</td>
</tr>

<tr>
  <td rowspan="4">Like.likeSum</td>
</tr>
<tr>
  <td>语法</td>
  <td>public int likeSum(long movieDetailsID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的电影</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回某电影想看的人数</td>
</tr>

<tr>
  <td rowspan="4">Like.everydayLike</td>
</tr>
<tr>
  <td>语法</td>
  <td>public Map everydayLike(long movieDetailsID)</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的电影</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回某电影自发布时间到当前日期每天想看的人数的Map</td>
</tr>

</table>

需要的服务（需接口）
<table>

<tr>
  <td>服务名</td>
  <td>服务</td>
</tr>
<tr>
  <td>DatabaseFacory.getLikeDatabase</td>
  <td>得到User数据库的服务的引用</td>
</tr>
<tr>
  <td>LikeDataService.find(long userID, long movieDetailsID)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>
<tr>
  <td>LikeDataService.find(long movieDetailsID)</td>
  <td>根据ID进行查找多个持久化对象</td>
</tr>
<tr>
  <td>LikeDataService.insert(LikePO po)</td>
  <td>在数据库中插入LikePO对象</td>
</tr>
<tr>
  <td>LikeDataService.delete(LikePO po)</td>
  <td>在数据库中删除LikePO对象</td>
</tr>

</table>

##### 5.3.2.5 schedulebl模块的接口规范

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Schedule.seekFreeTime</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResultMassage seekFreeTime(Date time,long hallID);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在该ID对应的影厅</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回该日期下该影厅可供排片的时间段和影片列表</td>
</tr>

<tr>
  <td rowspan="4">Schedule.addMovie</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResultMessage addMovie(Date[] time, long movieDetailsID, int money);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>该时间段为可供排片的时间段</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>添加排片信息，返回是否添加成功（是否有时间冲突）</td>
</tr>

<tr>
  <td rowspan="4">Schedule.check</td>
</tr>
<tr>
  <td>语法</td>
  <td>public long[] check(Date[] time, long[] hallIDs, boolean hallPerspective);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的影厅</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回包含以某种视角排好序的排片信息ID数组</td>
</tr>

<tr>
  <td rowspan="4">Schedule.scheduleList</td>
</tr>
<tr>
  <td>语法</td>
  <td>public long[] scheduleList(Date[] time);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回包含某时间段排片信息ID的数组</td>
</tr>

<tr>
  <td rowspan="4">Schedule.scheduleList</td>
</tr>
<tr>
  <td>语法</td>
  <td>public long[] scheduleList(Date[] time, long[] hallIDs);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>返回包含某时间段某影片排片信息ID的数组</td>
</tr>

<tr>
  <td rowspan="4">Schedule.setVisibleTime</td>
</tr>
<tr>
  <td>语法</td>
  <td>public boolean setVisibleTime(long[] scheduleIDs, Date[] time);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的排片</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>设置某日期或日期区间排片信息对观众可见时间，并返回是否设置成功（输入时间早于排片日期）</td>
</tr>

<tr>
  <td rowspan="4">Schedule.updateVisibleTime</td>
</tr>
<tr>
  <td>语法</td>
  <td>public boolean updateVisibleTime(long[] scheduleIDs, Date[] time);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的排片</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改某日期或日期区间排片信息对观众可见时间，并返回是否设置成功（输入时间早于排片日期）</td>
</tr>

<tr>
  <td rowspan="4">Schedule.delectSchedule</td>
</tr>
<tr>
  <td>语法</td>
  <td>public boolean delectSchedule(long scheduleID);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的排片</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除排片信息，并返回是否删除成功（当前时间是否早于排片信息对观众可见时间）</td>
</tr>

<tr>
  <td rowspan="4">Schedule.updateSchedule</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResultMassage updateSchedule(long scheduleID, Date[] time);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的排片</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改该时间段的排片信息，并返回是否修改成功（当前时间是否早于排片信息对观众可见时间、有无时间冲突、时间短于影片时长）</td>
</tr>

<tr>
  <td rowspan="4">Schedule.updateSchedule</td>
</tr>
<tr>
  <td>语法</td>
  <td>public ResultMassage updateSchedule(long scheduleID, long movieDetailsID);</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>存在ID对应的排片</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>修改该时间段的排片信息，并返回是否修改成功（当前时间是否早于排片信息对观众可见时间、有无时间短于影片时长）</td>
</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr>
  <td>ScheduleDataService.finds(Date[] time,long[] hallID)</td>
  <td>根据时间和影厅进行查找多个持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.insert(SchedulePO po)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.finds(Date[] time,long[] movieDetailsID)</td>
  <td>根据时间和电影进行查找多个持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.updates(SchedulePO po，Date time)</td>
  <td>更新多个持久化对象</td>
</tr>

<tr>
  <td>ScheduleDataService.updates(Date[] time)</td>
  <td>更新某个时间段多个持久化对象</td>
</tr>

<tr>
  <td>DatabaseFacory.getScheduleDatabase</td>
  <td>得到scheduleDatabase数据库的服务引用</td>
</tr>

<tr>
  <td>ScheduleDataService.delect(Date[] time)</td>
  <td>根据时间删除该时间段的对象</td>
</tr>

</table>

##### 5.3.2.6 promotionbl模块的接口规

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Promotion.addPromotion</td>
</tr>

<tr>
  <td>语法</td>
  <td>public void addPromotion(Date[] activeityTime,Date[] validTime,int money,String condition)</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>添加优惠政策</td>
</tr>

<tr>
  <td rowspan="4">Promotion.comparePromotion</td>
</tr>

<tr>
  <td>语法</td>
  <td>public boolean comparePromotion(Date[] activeityTime,Date[] validTime,int money,String condition)</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>跟优惠政策比较，返回是否满足优惠条件</td>
</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr> DatabaseFacory.getPromotionDatabase</td>
  <td>得到PromotionDatabase数据库的服务引用</td>
</tr>

<tr>PromotionDataService.insert(PromotionPO po) </td>
  <td>插入单一持久化对象</td>
</tr>

</table>

##### 5.3.2.7 salesbl模块的接口规范

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Sales.checkData</td>
</tr>

<tr>
  <td>语法</td>
  <td>public double checkData(String type)</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>返回该类统计数据对应的数据</td>
</tr>

<tr>
  <td rowspan="4">Sales.buyTicket</td>
</tr>

<tr>
  <td>语法</td>
  <td>public  boolean buyTicket(String[][]  seat,String  typePayment)</td>

</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>购票，返回是否成功</td>
</tr>

<tr>
  <td rowspan="4">Sales.checkTicket</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage checkTicket(）</td>

</tr>

<tr>
  <td>前置条件</td>
  <td>用户已购买电影票</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>返回已购电影票的详情</td>
</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr> DatabaseFacory.getSalesDatabase</td>
  <td>得到SalesDatabase数据库的服务引用</td>
</tr>

<tr> SalesDataService.find(int id)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>

<tr> SalesDataService.find(int userID)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>

<tr> SalesDataService.insert(SalesPO po)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr> SalesDataService.delect(SalesPO po)</td>
  <td>删除单一持久化对象</td>
</tr>

<tr> SalesDataService.update(SalesPO po)</td>
  <td>更新单一持久化对象</td>
</tr>

</table>

##### 5.3.2.8 memberbl模块的接口规范

提供的服务（供接口）

<table>
<tr>
  <td rowspan="4">Member.buy</td>
</tr>

<tr>
  <td>语法</td>
  <td>public void buy(String payment，String password )</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>购买会员卡</td>
</tr>

<tr>
  <td rowspan="4">Member.checkBalance</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage checkBalance(long id )</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>显示该用户的会员信息，包括会员卡余额等</td>
</tr>

<tr>
  <td rowspan="4">Member.recharge</td>
</tr>

<tr>
  <td>语法</td>
  <td>public ResultMassage recharge(String type，String password，int money )</td>
</tr>

<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>

<tr>
  <td>后置条件</td>
  <td>充值完成</td>
</tr>

</table>

需要的服务（需接口）

<table>
<tr>
  <td >服务名</td>

<td>服务</td></tr>

<tr> DatabaseFacory.getMemberDatabase</td>
  <td>得到MemberDatabase数据库的服务引用</td>
</tr>

<tr> MemberDataService.insert(MemberPO po)</td>
  <td>插入单一持久化对象</td>
</tr>

<tr> MemberDataService.find(long id)</td>
  <td>根据ID进行查找单一持久化对象</td>
</tr>

<tr> MemberDataService.update(MemberPO po)</td>
  <td>更新单一持久化对象</td>
</tr>

</table>

### 5.4 数据层分解

#### 5.4.1 职责

| 模块           | 职责                                                 |
| -------------- | :--------------------------------------------------- |
| UserDataService                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | 持续化数据库UserData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| UserDataServiceMySqlImpl | 基于MySql数据库的持续化数据库UserData的接口，提供集体载入、集体保存、增、删、改、查服务|
| MovieDetailDataService|持续化数据库MovieDetailData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| MovieDetailDataServiceMySqlImpl | 基于MySql数据库的持续化数据库MovieDetailData的接口，提供集体载入、集体保存、增、删、改、查服务|
| LikeDataService|持续化数据库LikeData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| LikeDataServiceMySqlImpl | 基于MySql数据库的持续化数据库LikeData的接口，提供集体载入、集体保存、增、删、改、查服务|
| ScheduleDataService|持续化数据库ScheduleData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| ScheduleDataServiceMySqlImpl | 基于MySql数据库的持续化数据库ScheduleData的接口，提供集体载入、集体保存、增、删、改、查服务|
| PromotionDataService|持续化数据库PromotionData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| PromotionDataServiceMySqlImpl | 基于MySql数据库的持续化数据库PromotionData的接口，提供集体载入、集体保存、增、删、改、查服务|
| HaspromotionDataService|持续化数据库HaspromotionData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| HasPromotionDataServiceMySqlImpl | 基于MySql数据库的持续化数据库HaspromotionData的接口，提供集体载入、集体保存、增、删、改、查服务|
| SalesDataService|持续化数据库SalesData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| SalesDataServiceMySqlImpl | 基于MySql数据库的持续化数据库SalesData的接口，提供集体载入、集体保存、增、删、改、查服务|
| MemberDataService|持续化数据库MemberData的接口，提供集体载入、集体保存、增、删、改、查服务               |
| MemberDataServiceMySqlImpl | 基于MySql数据库的持续化数据库MemberData的接口，提供集体载入、集体保存、增、删、改、查服务|
#### 5.4.2 接口规范
<table>

<tr>
  <td>UserDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">UserDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public UserPO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">UserDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(UserPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>


<tr>
  <td rowspan="4">UserDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">UserDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

<table>

<tr>
  <td>MovieDetailsDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">MovieDetailsDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public MovieDetailsPO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">MovieDetailsDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(MovieDetailsPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>

<tr>
  <td rowspan="4">MovieDetailsDataService.delete</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void delete(MovieDetailPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除一个po</td>
</tr>



<tr>
  <td rowspan="4">MovieDetailsDataService.update</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void update(MovieDetailsPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>更新一个po</td>
</tr>



<tr>
  <td rowspan="4">MovieDetailsDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">MovieDetailsDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

<table>

<tr>
  <td>LikeDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">LikeDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public LikePO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">LikeDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(LikePO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>

<tr>
  <td rowspan="4">LikeDataService.delete</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void delete(LikePO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除一个po</td>
</tr>




<tr>
  <td rowspan="4">LikeDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">LikeDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

<table>

<tr>
  <td>ScheduleDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">ScheduleDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public SchedulePO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">ScheduleDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(SchedulePO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>

<tr>
  <td rowspan="4">ScheduleDataService.delete</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void delete(SchedulePO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除一个po</td>
</tr>



<tr>
  <td rowspan="4">ScheduleDataService.update</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void update(SchedulePO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>更新一个po</td>
</tr>



<tr>
  <td rowspan="4">ScheduleDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">ScheduleDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

<table>

<tr>
  <td>PromotionDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">PromotionDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public PromotionPO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">PromotionDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(PromotionPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>

<tr>
  <td rowspan="4">PromotionDataService.delete</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void delete(PromotionPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除一个po</td>
</tr>
/tr>



<tr>
  <td rowspan="4">PromotionDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">PromotionDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

<table>

<tr>
  <td>HaspromotionDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">HaspromotionDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public HaspromotionPO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">HaspromotionDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(HaspromotionPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>

<tr>
  <td rowspan="4">HaspromotionDataService.delete</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void delete(HaspromotionPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除一个po</td>
</tr>




<tr>
  <td rowspan="4">HaspromotionDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">HaspromotionDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

<table>
<tr>
  <td>SalesDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">SalesDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public SalesPO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">SalesDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(SalesPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>

<tr>
  <td rowspan="4">SalesDataService.delete</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void delete(SalesPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除一个po</td>
</tr>



<tr>
  <td rowspan="4">SalesDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">SalesDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

<table>

<tr>
  <td>MemberDataService提供的服务（供接口）</td>
</tr>

<tr>
  <td rowspan="4">MemberDataService.find</td>
</tr>
<tr>
  <td>语法</td>
  <td>public MemberPO find(long id) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>按ID进行查找返回相应的PO结果</td>
</tr>

<tr>
  <td rowspan="4">MemberDataService.insert</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void insert(MemberPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>相同ID的po在Mapper中不存在</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>在数据库中增加一个po记录</td>
</tr>

<tr>
  <td rowspan="4">MemberDataService.delete</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void delete(MemberPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>删除一个po</td>
</tr>



<tr>
  <td rowspan="4">MemberDataService.update</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void update(MemberPO po) throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>在数据库中存在同样ID的po</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>更新一个po</td>
</tr>



<tr>
  <td rowspan="4">MemberDataService.init</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void init() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>初始化持久化数据库</td>
</tr>



<tr>
  <td rowspan="4">MemberDataService.finish</td>
</tr>
<tr>
  <td>语法</td>
  <td>public void finish() throws RemoteException;</td>
</tr>
<tr>
  <td>前置条件</td>
  <td>无</td>
</tr>
<tr>
  <td>后置条件</td>
  <td>结束持久化数据库的使用</td>
</tr>

</table>

### 6. 信息视角

- 描述数据持久化对象(PO)
  - 属性及其定义
  -UserPO类包含用户的用户名、密码、身份
  -HallPO类包含影厅名、影厅座位数
  -MovieDetailsPO类包含电影名称、电影宣传海报、导演、编剧、主演、类型、制片国家/地区、语言、上映日期、片场、下映日期
  -LikePO类包含一个电影详情编号MoviedetailsID、用户编号UserID、日期
  -SchedulePO类包含放映时间、放映影厅、电影详情编号MoviedetailsID、票价、是否可见
  -PromotionPO类包含优惠时间段、优惠金额、优惠条件
  -HaspromotionPO类包含一个用户编号UserID和促销编号PromotionID
  -SalesPO类包含用户编号UserID、放映编号ScheduleID、座位、支付状态
  -MemberPO类包含用户编号UserID、会员卡余额
持久化用户对象UserPO的定义如下：
```java
public class UserPO implements Serializable {
	int id;
	String name;
	String password;
	UserRole role;

	public UserPO(int i, String n, String p, UserRole r){
		id = i;
		name = n;
		password = p;
		role = r;
	}
	public String getName(){
		return name;
	}
	public int getID(){
		return id;
	}
	public String getPassword(){
		return password;
	}
	public UserRole getRole(){
		return role;
	}

}
```
持久化用户对象HallPO的定义如下：
```java
public class HallPO implements Serializable {
	int id;
	String name;
	int seats;

	public HallPO(int i, String n, int s){
		id = i;
		name = n;
		seats = s;
	}
	
	public int getID(){
		return id;
	}
	public String getName(){
		return name;
	}
	public int getSeats(){
		return seats;
	}
}
```
持久化用户对象MovieDetailsPO的定义如下：
```java
public class MovieDetailsPO implements Serializable {
	int id;
	String name;
	Image image;
	String director;
	String writer;
	String starring;
	Movietype type;
	Moviecountry country;
	Language language;
	Date rdate;
	int movielength;
	Date odate;

	public MovieDetailsPO(int i, String n,Image img, String dir, String wri, String star, Movietype t, Moviecountry coun, Language lan, Date rd, int len, Date od){
		id = i;
		name = n;
		image = img;
		director = dir;
		writer = wri;
		starring = star;
		type = t;
		country = coun;
		language = lan;
		rdate = rd;
		movielength = len;
		odate = od;
	}
	
	public int getID(){
		return id;
	}
	public String getName(){
		return name;
	}
	public Image getImage(){
		return image;
	}
	public String getDirector){
		return director;
	}
	public String getWriter(){
		return writer;
	}
	public String getStarring(){
		return starring;
	}
	public Movietype getType(){
		return type;
	}
	public Moviecountry getCountry(){
		return country;
	}
	public Language getlanguege(){
		return language;
	}
	public Date getRdate(){
		return rdate;
	}
	public int getMovielength(){
		return movielength;
	}
	public Date getOdate(){
		return odate;
	}
	

}
```
持久化用户对象LikePO的定义如下：
```java
public class LikePO implements Serializable {
	int id;
	int MoviedetailId;
	int UserId;
	Date date;
	
	public LikePO(int i, int mid, int uid, Date d){
		id = i;
		MoviedetailId = mid;
		UserId = uid;
		date = d;
	}
	
	public int getID(){
		return id;
	}
	public int getMovieID(){
		return MoviedetailId;
	}
	public int getUserID(){
		return UserId;
	}
	public Date getDate(){
		return date;
	}
	
}
```
持久化用户对象SchedulePO的定义如下：
```java
public class SchedulePO implements Serializable {
	int id;
	String time;
	String hall;
	float fare;
	boolean vis;

	public SchedulePO(int i, String t, String h, float f, boolean v){
		id = i;
		hall = h;
		fare = f;
		vis = v;
	}

	public int getID(){
		return id;
	}
	public String getTime(){
		return time;
	}
	public String getHall(){
		return hall;
	}
	public float getFare(){
		return fare;
	}
	public boolean getVis(){
		return vis;
	}
}
```
持久化用户对象PromotionPO的定义如下：
```java
public class PromotionPO implements Serializable {
	int id;
	String starttime;
	String overtime;
	float amount;
	String condition;
	
	public PromitonPO(int i, String s, String o,float a, String c){
		id = i;
		starttime = s;
		overtime = o;
		amount = a;
		condition = c;
	}
	
	public int getID(){
		return id;
	}
	public String getStarttime(){
		retrun starttime;
	}
	public String getOvertime(){
		retrun overtime;
	}
	public float getAmount(){
		return amount;
	}
	public String GetCondition(){
		return condition;
	}
}
```
持久化用户对象HaspromotionPO的定义如下：
```java
public class HaspromotionPO implements Serializable {
	int id;
	int userid;
	int promotionid;
	
	public HaspromotionPO(int i, int u, int p){
		id = i;
		userid = u;
		promitionid = p;
	}

	public int getID(){
		return id;
	}
	public int getUserid(){
		return userid;
	}
	public int getPromitionid(){
		return promotionid;
	}
}
```
持久化用户对象SalesPO的定义如下：
```java
public class SalesPO implements Serializable {
	int id;
	int userid;
	int scheduleid;
	int seats;
	Status status;

	public SalesPO(int i, int u, int s, int se, Status st){
		id = i;
		userid = u;
		scheduleid = s;
		seats = se;
		status = st;
	}
	
	public int getID(){
		return id;
	}
	public int getUserid(){
		return userid;
	}
	public int getScheduleid(){
		return scheduleid;
	}
	public int getSeats(){
		return seats;
	}
	public Status getStatus(){
		return status;
	}
	
}
```
持久化用户对象MemberPO的定义如下：
```java
public class MemberPO implements Serializable {
	int id;
	int userid;
	float balance;

	public MemberPO(int i, int u, float b){
		id = i;
		userid = u;
		balance = b;
	}

	public int getID(){
		return id;
	}
	public int getUserid(){
		return userid;
	}
	public float getBalance(){
		return blance;
	}
	
}
```

  - 类型
