# 软件体系结构文档模板

## 文档修改历史

| 修改人员 | 日期       | 修改原因                                     | 版本号 |
|:--------:| ---------- | -------------------------------------------- | ------ |
***梁正川***

## 目录
***梁正川***

				1. 引言
					1.1 编制目的
					1.2 词汇表
					1.3 参考资料
	
				2. 产品概述
				3. 逻辑视图
				4. 组合视图
					4.1 开发包图
					4.2 运行时进程
					4.3 物理部署
					4.4 架构设计
	
				5. 接口视角
					5.1 模块职责
					5.2 用户界面层分解
					5.2.1 职责
					5.2.2 接口规范
						5.2.2.1 mainui接口规范
						5.2.2.2 userui接口规范
						5.2.2.3 moviedetailsui接口规范
						5.2.2.4 likeui接口规范
						5.2.2.5 scheduleui接口规范
						5.2.2.6 promotionui接口规范
						5.2.2.7 salesui接口规范
						5.2.2.8 memberui接口规范
	
					5.2.3 设计原理
	
				5.3 业务逻辑层分解
					5.3.1 职责
					5.3.2 接口规范
						5.3.2.1 userbl模块的接口规范
						5.3.2.2 hallbl模块的接口规范
						5.3.2.3 moviedetailsbl模块的接口规范
						5.3.2.4 likebl模块的接口规范
						5.3.2.5 schedulebl模块的接口规范
						5.3.2.6 promotionbl模块的接口规
						5.3.2.7 salesbl模块的接口规范
						5.3.2.8 memberbl模块的接口规范
	
					5.4 数据层分解
						5.4.0 数据层模块描述
							5.4.0.1 UserDataService
							5.4.0.2 HallDataService
							5.4.0.3 MovieDetailsDataService
							5.4.0.4 LikeDataService
							5.4.0.5 ScheduleDataService
							5.4.0.6 PromotionDataService
							5.4.0.7 HaspromotionDataService
							5.4.0.8 SalesDataService
							5.4.0.9 MemberDataService
	
						5.4.1 职责
						5.4.2 接口规范
							5.4.2.1 UserDataService模块的接口规范
							5.4.2.2 HallDataService模块的接口规范
							5.4.2.3 MovieDataService模块的接口规范
							5.4.2.4 LikeDataService模块的接口规范
							5.4.2.5 ScheduleDataService模块的接口规范
							5.4.2.6 PromotionDataService模块的接口规范
							5.4.2.7 HaspromotionDataService模块的接口规范
							5.4.2.8 SalesDataDataService模块的接口规范
							5.4.2.9 MemberDataDataService模块的接口规范
	
				6. 信息视角
					6.1 持续化对象
						6.1.1 描述数据持续化对象
						6.1.2 持续化用户对象的定义
							6.1.2.1 UserPO对象的定义
							6.1.2.2 HallPO对象的定义
							6.1.2.3 MovieDetailsPO对象的定义
							6.1.2.4 LikePO对象的定义
							6.1.2.5 SchedulePO对象的定义
							6.1.2.6 PromotionPO对象的定义
							6.1.2.7 HaspromotionPO对象的定义
							6.1.2.8 SalesPO对象的定义
							6.1.2.9 MemberPO对象的定义
	
					6.2 数据库表

## 1. 引言

### 1.1 编制目的

本报告详细完成对影院管理系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

### 1.2 词汇表

| 词汇名称 | 词汇含义 | 备注 |
| :------: | -------- | ---- |
|          |          |      |
此表为空


### 1.3 参考资料

软件开发的技术基础 软件工程与计算（卷二） —— 罗斌、丁二玉、刘钦

## 2. 产品概述

参考影院管理系统用例文档和影院管理系统软件需求规格说明中对产品的概括描述。

## 3. 逻辑视图

影院管理系统中，选择了分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层）能够很好地示意整个高层抽象。展示层包含WEB页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如示意图所示。

![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E9%80%BB%E8%BE%91%E8%A7%86%E8%A7%92.jpg?raw=true)
参照体系结构风格的包图表达逻辑视角

![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88.jpg)
软件体系结构逻辑设计方案（注：无hallui，此为第三阶段的需求，但第一、二阶段需要hallbussinesslogic和halldata）

## 4. 组合视图

### 4.1 开发包图

影院管理系统的最终开发包设计如下表所示。

|         开发包          | 依赖的其他开发包                                                               |
|:-----------------------:| ------------------------------------------------------------------------------ |

影院管理系统的最终开发包图如下图所示。
![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE.jpg?raw=true)

### 4.2 运行时进程

影院管理系统会有客户使用的浏览器进程和服务器端进程，通过HTTP协议通讯。
![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E8%BF%9B%E7%A8%8B%E5%9B%BE.jpg?raw=true)


### 4.3 物理部署

影院管理系统在系统JDK环境已经设置好的情况下，不需要再独立部署。部署图如下图所示。

![icon](http://assets.processon.com/chart_image/5ae5be27e4b039625af793c0.png?_=1554259679134)

###4.4 架构设计

## 5. 接口视角

### 5.1 模块职责

- 模块视图

![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E6%A8%A1%E5%9D%97%E8%A7%86%E5%9B%BE.jpg?raw=true)


- 各层职责

|  层        | 职责     |
| :--------: | -------- |
| 启动模块 | 启动用户界面 |
| 用户界面层 | 展示用户界面 |
| 业务逻辑层 | 对于用户界面的输入进行响应并进行业务处理逻辑 |
| 数据层     | 负责数据的持久化及数据访问接口 |

- 层之间调用接口

| 接口 | 服务调用方       | 服务提供方          |
| :--: | ---------------- | ------------------- |

### 5.2 用户界面层分解

根据需求，系统存在25个用户界面：登录界面、注册界面、管理员主界面、观众主界面、影院员工主界面、电影上架界面、电影下架界面、统计电影想看人数界面、查看电影列表界面、电影详情界面界面、查看电影票界面、查看排片信息界面、搜索电影界面、会员卡界面、购买会员卡界面、查看会员卡界面、充值会员卡界面、购买电影票界面、电影排片界面、添加排片信息界面、修改排片信息界面、删除排片信息界面、查看排片信息界面、查看统计数据界面、发布优惠活动界面。界面跳转如下图所示。

![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%B1%82%E7%9A%84%E5%88%86%E8%A7%A3-%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E8%B7%B3%E8%BD%AC.jpg?raw=true)

用户界面类如下图所示。
![](https://github.com/president-for-life/NJU-SF2/blob/master/%E5%9B%BE%E7%89%87/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%B1%82%E7%9A%84%E5%88%86%E8%A7%A3-%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E7%B1%BB.png?raw=true)

#### 5.2.1 职责

用户界面层模块的职责如下表所示。

| 模块           | 职责                                                   |
| -------------- | ------------------------------------------------------ |
| MainFrame      | 界面Frame，负责界面的显示和界面的跳转                  |

#### 5.2.2 接口规范

用户界面层模块的接口规范如下表所示。

##### 5.2.2.1 mainui接口规范

<table>
<tr><td rowspan="4">MainFrame.init</td></tr>
<tr><td>语法</td><td>init(args:String[])</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示Frame以及loginPanel</td></tr>
</table>

##### 5.2.2.2 userui接口规范

<table>
<tr><td rowspan="4">UserPanel.login</td></tr>
<tr><td>语法</td><td>public void login()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示登录界面</td></tr><tr><td rowspan="4">UserPanel.register</td></tr>
<tr><td>语法</td><td>public void register()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示注册界面</td></tr><tr><td rowspan="4">MangerPanel.init()</td></tr>
<tr><td>语法</td><td>public void init()</td></tr>
<tr><td>前置条件</td><td>管理员身份已验证</td></tr>
<tr><td>后置条件</td><td>显示管理员主界面</td></tr><tr><td rowspan="4">AudiencePanel.init()</td></tr>
<tr><td>语法</td><td>public void init()</td></tr>
<tr><td>前置条件</td><td>观众身份已验证</td></tr>
<tr><td>后置条件</td><td>显示观众主界面</td></tr><tr><td rowspan="4">StaffPanel.init()</td></tr>
<tr><td>语法</td><td>public void init()</td></tr>
<tr><td>前置条件</td><td>影院员工身份已验证</td></tr>
<tr><td>后置条件</td><td>显示影院员工界面</td></tr>
</table>
##### 5.2.2.3 moviedetailsui接口规范

<table>
<tr><td rowspan="4">MovieDetailsPanel.putOnMovie</td></tr>
<tr><td>语法</td><td>public void putOnMovie()</td></tr>
<tr><td>前置条件</td><td>以管理员身份登陆</td></tr>
<tr><td>后置条件</td><td>显示电影上架界面</td></tr><tr><td rowspan="4">MovieDetailsPanel.showMovieList</td></tr>
<tr><td>语法</td><td>public void showMovieList()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示电影列表查看界面</td></tr><tr><td rowspan="4">MovieDetailsPanel.showMovieDetails</td></tr>
<tr><td>语法</td><td>public void showMovieDetails(long movieID)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示电影详情查看界面</td></tr>
</table>
##### 5.2.2.4 likeui接口规范

<table>
<tr><td rowspan="4">LikePanel.countMovieLike</td></tr>
<tr><td>语法</td><td>publci void countMovieLike()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示所有电影的想看人数统计界面</td></tr>
<tr><td rowspan="4">LikePanel.countMovieLike</td></tr>
<tr><td>语法</td><td>public void countMovieLike(long movieID)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示指定电影的想看人数统计界面</td></tr>
<tr><td rowspan="4">LikePanel.likeMovie</td></tr>
<tr><td>语法</td><td>public void likeMovie(long movieID)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示标记电影为想看界面</td></tr>
</table>

##### 5.2.2.5 scheduleui接口规范

<table>
<tr><td rowspan="4">SchedulePanel.scheduleMovie</td></tr>
<tr><td>语法</td><td>public void scheduleMovie()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示电影排片界面</td></tr>
</table>

##### 5.2.2.6 promotionui接口规范
<table>
<tr><td rowspan="4">PromotionPanel.releasePromotion</td></tr>
<tr><td>语法</td><td>public void releasePromotion()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示优惠活动发布界面</td></tr>
</table>

##### 5.2.2.7 salesui接口规范

<table>
<tr><td rowspan="4">SalesPanel.buyTicket</td></tr>
<tr><td>语法</td><td>public void buyTicket()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示电影票购买界面</td></tr><tr><td rowspan="4">SalesPanel.doStatistics</td></tr>
<tr><td>语法</td><td>public void doStatistics()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示统计数据查看界面</td></tr>
</table>
##### 5.2.2.8 memberui接口规范

<table>
<tr><td rowspan="4">MemberPanel.buyMemberCard</td></tr>
<tr><td>语法</td><td>public void buyMemberCard()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示会员卡购买界面</td></tr><tr><td rowspan="4">MemberPanel.showMemberCardDetails</td></tr>
<tr><td>语法</td><td>public void showMemberCardDetails()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示会员卡查看界面</td></tr><tr><td rowspan="4">MemberPanel.topUpMemberCard</td></tr>
<tr><td>语法</td><td>public void topUpMemberCard()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>显示会员卡充值界面</td></tr>
</table>
用户界面层需要的服务接口如下表所示。

| 服务名                                     | 服务                                                   |
| ------------------------------------------ | ------------------------------------------------------ |
| businesslogicservice.userblservice         | 观众、管理员、影院员工登录、注册界面的业务逻辑接口     |
| businesslogicservice.moviedetailsblservice | 电影上架、电影列表查看、电影详情查看界面的业务逻辑接口 |
| businesslogicservice.likeblservice         | 电影标记、电影想看人数统计界面的业务逻辑接口           |
| businesslogicservice.scheduleblservice     | 排片界面的业务逻辑接口                                 |
| businesslogicservice.promotionblservice    | 优惠活动发布界面的业务逻辑接口                         |
| businesslogicservice.salesblservice        | 电影票购买、统计数据查看界面的业务逻辑接口             |
| businesslogicservice.memberblservice       | 会员卡购买、会员卡查看、会员卡充值界面的业务逻辑接口   |

#### 5.2.3 设计原理

用户界面利用JavaScript、CSS、HTML来实现。

### 5.3 业务逻辑层分解


#### 5.3.1 职责

| 模块      | 职责                                                         |
| --------- | :----------------------------------------------------------- |
| promotion | 负责实现优惠活动管理、优惠券管理、会员卡充值优惠策略管理、会员卡管理、查看历史充值所需要的服务 |
| sales     | 负责实现新增退票策略、修改退票策略、增/删使用某退票策略的电影、观众取票、观众退票、查看历史消费记录所需要的服务 |
| statisti  | 负责实现优惠券管理所需要的服务                               |

#### 5.3.2 接口规范

##### 5.3.2.1 promotion模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr><tr><td rowspan="4">promotion.participate</td></tr>
<tr><td>语法</td><td>public void participate(int movieId, int userId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>如果观看该电影为单个或多个优惠活动的参与条件，用户获得这些优惠活动的优惠券</td></tr><tr><td rowspan="4">promotion.getValidCoupons</td></tr>
<tr><td>语法</td><td>public ResponseVO getValidCoupons()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回当前处于有效期的优惠劵</td></tr><tr><td rowspan="4">promotion.issueCoupon</td></tr>
<tr><td>语法</td><td>public ResponseVO issueCoupon(List<Integer> couponIdList, List<Integer> userIdList)</td></tr>
<tr><td>前置条件</td><td>优惠券列表和用户列表中的id有效</td></tr>
<tr><td>后置条件</td><td>返回赠送是否成功</td></tr><tr><td rowspan="4">promotion.addStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO addStrategy(VIPCardStrategyForm strategyForm)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回发布会员卡充值优惠策略是否成功</td></tr><tr><td rowspan="4">promotion.updateStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO updateStrategy(VIPCardStrategyForm strategyForm)</td></tr>
<tr><td>前置条件</td><td>strategyForm中的id属性有效</td></tr>
<tr><td>后置条件</td><td>返回发布会员卡充值优惠策略修改是否成功</td></tr><tr><td rowspan="4">promotion.removeStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO removeStrategy(int strategyId)</td></tr>
<tr><td>前置条件</td><td>strategyId有效</td></tr>
<tr><td>后置条件</td><td>返回发布会员卡充值优惠策略删除是否成功</td></tr><tr><td rowspan="4">promotion.getAllStrategies</td></tr>
<tr><td>语法</td><td>public ResponseVO getAllStrategies()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回所有会员卡充值优惠策略</td></tr><tr><td rowspan="4">promotion.addVIPCard</td></tr>
<tr><td>语法</td><td>ResponseVO addVIPCard(int userId, int strategyId)</td></tr>
<tr><td>前置条件</td><td>userId和strategyId有效</td></tr>
<tr><td>后置条件</td><td>如果用户已有会员卡，切换会员卡；否则，新增会员卡</td></tr><tr><td rowspan="4">promotion.pay</td></tr>
<tr><td>语法</td><td>public boolean pay(int userId, double pay)</td></tr>
<tr><td>前置条件</td><td>userId有效，pay >= 0</td></tr>
<tr><td>后置条件</td><td>返回会员卡支付是否成功</td></tr><tr><td rowspan="4">promotion.getCardByUserId</td></tr>
<tr><td>语法</td><td>public ResponseVO getCardByUserId(int userId)</td></tr>
<tr><td>前置条件</td><td>userId有效</td></tr>
<tr><td>后置条件</td><td>返回用户持有的会员卡</td></tr><tr><td rowspan="4">promotion.getChargeRecords</td></tr>
<tr><td>语法</td><td>public ResponseVO getChargeRecords(int vipCardId)</td></tr>
<tr><td>前置条件</td><td>vipCardId有效</td></tr>
<tr><td>后置条件</td><td>返回用户持有的会员卡的充值记录</td></tr><tr><td colspan="3"><center>需要的服务（需接口）</center></td></tr><tr><td>服务名</td><td colspan="2">服务</td></tr>
<tr><td>ActivityMapper.selectActivitiesByMovie(int movieId)</td><td colspan="2">选择优惠电影列表中含有某电影的优惠活动</td></tr>
<tr><td>ActivityMapper.selectActivitiesWithoutMovie()</td><td colspan="2">选择条件为“观看任意电影”的优惠活动</td></tr>
<tr><td>CouponServiceForBl.issueCoupon(List<Integer> couponIdList, List<Integer> userIdList)</td><td colspan="2">让多个观众每人都获得多个优惠劵</td></tr>
<tr><td>CouponMapper.selectValidCoupons()</td><td colspan="2">获得当前处于有效期的优惠劵</td></tr>
<tr><td>CouponMapper.insertCouponUser(couponId, userId)</td><td colspan="2">让某观众获得某优惠劵</td></tr>
<tr><td>VIPCardMapper.insertStrategy(VIPCardStrategy vipCardStrategy)</td><td colspan="2">插入单一会员卡充值优惠策略</td></tr>
<tr><td>VIPCardMapper.updateStrategy(VIPCardStrategy vipCardStrategy)</td><td colspan="2">更新单一会员卡充值优惠策略</td></tr>
<tr><td>VIPCardMapper.deleteStrategy(int id)</td><td colspan="2">删除单一会员卡充值优惠策略</td></tr>
<tr><td>VIPCardMapper.selectStrategies()</td><td colspan="2">查找所有会员卡充值优惠策略</td></tr>
<tr><td>VIPCardMapper.selectCardByUserId(int userId)</td><td colspan="2">根据userId查找单一会员卡</td></tr>
<tr><td>VIPCardMapper.insertOneCard(VIPCard vipCard)</td><td colspan="2">插入单一会员卡</td></tr>
<tr><td>VIPCardMapper.updateCardStrategy(int id, int strategyId)</td><td colspan="2">更新单一会员卡充值优惠策略</td></tr>
<tr><td>VIPCardMapper.updateCardBalance(int id, double balance)</td><td colspan="2">更新单一会员卡余额</td></tr>
<tr><td>VIPCardMapper.selectChargeRecordsByCard(int vipCardId)</td><td colspan="2">根据vipCardId查找单一会员卡的多个充值记录</td></tr></table>

##### 5.3.2.2 sales模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr><tr><td rowspan="4">sales.pickUpTicket</td></tr>
<tr><td>语法</td><td>public ResponseVO pickUpTicket(int ticketId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>如果当前电影票是“已支付但未取票”状态，则修改其状态为“已取票”</td></tr><tr><td rowspan="4">sales.addRefundStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO addRefundStrategy(TicketRefundStrategyForm strategyForm)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>记录被新增的退票策略</td></tr><tr><td rowspan="4">sales.updateRefundStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO updateRefundStrategy(TicketRefundStrategyForm strategyForm)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>记录被修改的退票策略</td></tr><tr><td rowspan="4">sales.addRefundMovies</td></tr>
<tr><td>语法</td><td>public ResponseVO addRefundMovies(int refundStrategyId, List<Integer> movieIdList)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>记录指定退票策略新增的电影列表</td></tr><tr><td rowspan="4">sales.removeRefundMovies</td></tr>
<tr><td>语法</td><td>public ResponseVO removeRefundMovies(int refundStrategyId, List<Integer> movieIdList)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>更新要删除指定电影的退票策略</td></tr><tr><td rowspan="4">sales.addRefundTicket</td></tr>
<tr><td>语法</td><td>public ResponseVO addRefundTicket(int ticketId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回用户想要退票的电影票对应的退票策略</td></tr><tr><td rowspan="4">sales.completeRefundTicket</td></tr>
<tr><td>语法</td><td>public ResponseVO completeRefundTicket(int ticketId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>将指定的电影票的状态修改为"已退票"</td></tr><tr><td rowspan="4">sales.getTicketsByUser</td></tr>
<tr><td>语法</td><td>public ResponseVO getTicketsByUser(int userId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回用户买过的所有电影票</td></tr><tr><td rowspan="4">sales.searchAllRefundStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO searchAllRefundStrategy()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回所有已有的退票策略</td></tr><tr><td rowspan="4">sales.getMoviesNotInRefundStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO getMoviesNotInRefundStrategy()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回没有被指定退票策略的电影列表，并且这些电影状态是“未下架”</td></tr><tr><td rowspan="4">sales.getMoviesByRefundStrategy</td></tr>
<tr><td>语法</td><td>public ResponseVO getMoviesByRefundStrategy(int strategyId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回使用指定退票策略的电影列表</td></tr><tr><td rowspan="4">sales.getOrdersByUser</td></tr>
<tr><td>语法</td><td>public ResponseVO getOrdersByUser(int userId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回用户的所有订单</td></tr><tr><td colspan="3"><center>需要的服务（需接口）</center></td></tr>
<tr><td>服务名</td><td colspan="2">服务</td></tr><tr><td>TicketMapper.selectTicketById(int ticketId)</td><td colspan="2">根据指定电影票号获取电影票</td></tr><tr><td>TicketMapper.updateTicketState(int ticketId,int state)</td><td colspan="2">更新指定电影票的状态</td></tr><tr><td>TicketMapper.insertOneRefundStrategy(TicketRefundStrategy strategy)</td><td colspan="2">记录新增的退票策略</td></tr><tr><td>TicketMapper.updateRefundStrategy(TicketRefundStrategy strategy)</td><td colspan="2">更新修改的退票策略</td></tr><tr><td>TicketMapper.insertStrategyAndMovies(int strategyId, List<Integer> movieIdList)</td><td colspan="2">记录某退票策略新增的电影列表</td></tr><tr><td>TicketMapper.deleteStrategyAndMovies(int strategyId, List<Integer> movieIdList)</td><td colspan="2">删除某退票策略指定的电影列表</td></tr><tr><td>TicketMapper.selectRefundStrategyByMovie(int movieId)</td><td colspan="2">获取指定电影对应的退票策略</td></tr><tr><td>TicketMapper.selectTicketsByUser(int userId)</td><td colspan="2">获取指定用户所有的电影票</td></tr><tr><td>TicketMapper.selectRefundStrategies()</td><td colspan="2">获取已有的所有退票策略</td></tr><tr><td>TicketMapper.selectMovieNotInRefundStrategy()</td><td colspan="2">获取未被指定退票策略的电影列表</td></tr><tr><td>TicketMapper.selectRefundStrategyById(int strategyId)</td><td colspan="2">根据退票策略号获取指定退票策略</td></tr><tr><td>ScheduleServiceForBl.getScheduleItemById(int scheduleId)</td><td colspan="2">根据拍片号获取指定的拍片信息</td></tr></table>
##### 5.3.2.3 statistics模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr><tr><td rowspan="4">statistics.consumption</td></tr>
<tr><td>语法</td><td> public ResponseVO getConsumption(double amount)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
    <tr><td>后置条件</td><td>获取达到一定消费的会员</td></tr></table>

<table><tr><td>服务名</td><td colspan="2">服务</td></tr><tr><td>StatisticsMapper.selectConsumption</td><td colspan="2">根据消费金额选择所有大于等于该金额的会员</td></tr></table>



```

```

### 5.4 数据层分解

####5.4.0 数据层模块描述

#####5.4.0.1 UserDataService

![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/1User.png)
#####5.4.0.2 HallDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/2Hall.png)
#####5.4.0.3 MovieDetailsDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/3MovieDetail.png)
#####5.4.0.4 LikeDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/4Like.png)
#####5.4.0.5 ScheduleDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/5Schedule.png)
#####5.4.0.6 PromotionDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/6Promotion.png)
#####5.4.0.7 HaspromotionDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/7Haspromotion.png)
#####5.4.0.8 SalesDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/8Sales.png)
#####5.4.0.9 MemberDataService
![](https://raw.githubusercontent.com/president-for-life/NJU-SF2/master/%E5%9B%BE%E7%89%87/%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E8%A1%A8%E7%A4%BA/9Member.png)

#### 5.4.1 职责

| 模块           | 职责                                                 |
| -------------- | :--------------------------------------------------- |
| data.promotion.ActivityMapper | 持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| dataImpl.promotion.ActivityMapper | 基于MySql数据库的持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| data.promotion.CouponMapper | 持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| dataImpl.promotion.CouponMapper | 基于MySql数据库的持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| data.promotion.VIPCardMapper | 持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| dataImpl.promotion.VIPCardMapper | 基于MySql数据库的持续化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |


#### 5.4.2 接口规范

##### 5.4.2.1 ActivityMapper模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr>
</table>

##### 5.4.2.2 CouponMapper模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr>

<tr><td rowspan="4">CouponMapper.selectValidCoupons</td></tr>
<tr><td>语法</td><td>List<Coupon> selectValidCoupons()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回当前处于有效期的优惠劵</td></tr>
</table>

##### 5.4.2.3 VIPCardMapper模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr>

<tr><td rowspan="4">VIPCardMapper.insertStrategy</td></tr>
<tr><td>语法</td><td>int insertStrategy(VIPCardStrategy vipCardStrategy)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库插入一个会员卡充值优惠策略</td></tr>

<tr><td rowspan="4">VIPCardMapper.updateStrategy</td></tr>
<tr><td>语法</td><td>void updateStrategy(VIPCardStrategy vipCardStrategy)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库更新一个会员卡充值优惠策略</td></tr>

<tr><td rowspan="4">VIPCardMapper.deleteStrategy</td></tr>
<tr><td>语法</td><td>void deleteStrategy(int id)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库删除一个会员卡充值优惠策略</td></tr>

<tr><td rowspan="4">VIPCardMapper.selectStrategyById</td></tr>
<tr><td>语法</td><td>VIPCardStrategy selectStrategyById(int id)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>按ID查找返回一个会员卡充值优惠策略</td></tr>

<tr><td rowspan="4">VIPCardMapper.selectStrategies</td></tr>
<tr><td>语法</td><td>List<VIPCardStrategy> selectStrategies()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回所有会员卡充值优惠策略</td></tr>

<tr><td rowspan="4">VIPCardMapper.strategyUseCount</td></tr>
<tr><td>语法</td><td>int strategyUseCount(int id)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>返回使用某会员卡充值优惠策略的会员卡数量</td></tr>

<tr><td rowspan="4">VIPCardMapper.insertOneCard</td></tr>
<tr><td>语法</td><td>void insertOneCard(VIPCard vipCard)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库插入一个会员卡</td></tr>

<tr><td rowspan="4">VIPCardMapper.updateCardStrategy</td></tr>
<tr><td>语法</td><td>void updateCardStrategy(int id, int strategyId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>更新会员卡使用的充值优惠策略</td></tr>

<tr><td rowspan="4">VIPCardMapper.selectCardById</td></tr>
<tr><td>语法</td><td>VIPCard selectCardById(int id)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>按ID查找返回一个会员卡</td></tr>

<tr><td rowspan="4">VIPCardMapper.selectCardByUserId</td></tr>
<tr><td>语法</td><td>VIPCard selectCardByUserId(int userId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>按userId查找返回一个会员卡</td></tr>

<tr><td rowspan="4">VIPCardMapper.insertOneChargeRecord</td></tr>
<tr><td>语法</td><td>int insertOneChargeRecord(VIPCardCharge charge)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库插入一个会员卡充值记录</td></tr>

<tr><td rowspan="4">VIPCardMapper.selectChargeRecordsByCard</td></tr>
<tr><td>语法</td><td>List<VIPCardCharge> selectChargeRecordsByCard(int vipCardId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>按vipCardId查找多个会员卡充值记录</td></tr>
</table>

##### 5.4.2.4 TicketMapper模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr>
<tr><td rowspan="4">TicketMapper.insertOneRefundStrategy</td></tr>
<tr><td>语法</td><td>int insertOneRefundStrategy(TicketRefundStrategy strategy)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库插入一个退票策略</td></tr>

<tr><td rowspan="4">TicketMapper.updateOneRefundStrategy</td></tr>
<tr><td>语法</td><td>void updateOneRefundStrategy(TicketRefundStrategy strategy)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库更新一个退票策略</td></tr>

<tr><td rowspan="4">TicketMapper.insertStrategyAndMovies</td></tr>
<tr><td>语法</td><td>int insertStrategyAndMovies(int strategyId, List<Integer> movieIdList)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库插入一个退票策略对应的电影列表</td></tr>

<tr><td rowspan="4">TicketMapper.deleteStrategyAndMovies</td></tr>
<tr><td>语法</td><td>void deleteStrategyAndMovies(int strategyId, List<Integer> movieIdList)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库删除一个退票策略对应的电影列表</td></tr>

<tr><td rowspan="4">TicketMapper.selectRefundStrategyById</td></tr>
<tr><td>语法</td><td>TicketRefundStrategy selectRefundStrategyById(int strategyId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库中根据退票策略ID选择一个退票策略</td></tr>

<tr><td rowspan="4">TicketMapper.selectRefundStrategyByMovie</td></tr>
<tr><td>语法</td><td>TicketRefundStrategy selectRefundStrategyByMovie(int movieId)</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库中根据电影ID选择一个退票策略</td></tr>

<tr><td rowspan="4">TicketMapper.updateStrategy</td></tr>
<tr><td>语法</td><td>List<TicketRefundStrategy> selectRefundStrategies()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库中选择所有的退票策略</td></tr>

<tr><td rowspan="4">TicketMapper.selectMovieNotInRefundStrategy</td></tr>
<tr><td>语法</td><td>List<Movie> selectMovieNotInRefundStrategy()</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库中选择没有被指定退票策略的电影</td></tr>
</table>

##### 5.4.2.5 StatisticsMapper模块的接口规范

<table>
<tr><td colspan="3"><center>提供的服务（供接口）</center></td></tr><tr><td rowspan="4">StatisticsMapper.selectConsumption</td></tr>
<tr><td>语法</td><td>List<Consumption> selectConsumption(double amount);</td></tr>
<tr><td>前置条件</td><td>无</td></tr>
<tr><td>后置条件</td><td>在数据库根据消费金额选择所有大于等于该金额的会员</td></tr></table>

### 6. 信息视角

####6.1 持续化对象
##### 6.1.1 描述数据持续化对象
- 描述数据持久化对象(PO)
  - 属性及其定义
  
    -VIPCard类包含会员卡的ID、使用的充值优惠策略ID、用户ID、余额、参与日期。
    -VIPCardStrategy类包含会员卡充值优惠策略ID、价格、描述、充值优惠须满金额、优惠金额。
    -VIPCardCharge类包含会员卡ID、充值时间、支付金额、充入金额。
  
    -Consumption 类包含用户ID、消费金额。
  
    

##### 6.1.2 持续化对象的定义

###### 6.1.2.1 VIPCard对象的定义
持久化用户对象VIPCard的定义如下：
```java
public class VIPCard {
    private int id;
    private int strategyId;
    private int userId;
    private double balance;
    private Timestamp joinDate;

    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public int getStrategyId() {
        return strategyId;
    }
    public void setStrategyId(int strategyId) {
        this.strategyId = strategyId;
    }
    public int getUserId() {
        return userId;
    }
    public void setUserId(int userId) {
        this.userId = userId;
    }
    public double getBalance() {
        return balance;
    }
    public void setBalance(double balance) {
        this.balance = balance;
    }
    public Timestamp getJoinDate() {
        return joinDate;
    }
    public void setJoinDate(Timestamp joinDate) {
        this.joinDate = joinDate;
    }
}
```

###### 6.1.2.2 VIPCardStrategy对象的定义
持久化用户对象VIPCardStrategy的定义如下：
```java
public class VIPCardStrategy {
    private int id;
    private double price;
    private String description;
    private double targetAmount;
    private double discountAmount;

    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public double getPrice() {
        return price;
    }
    public void setPrice(double price) {
        this.price = price;
    }
    public String getDescription() {
        return description;
    }
    public void setDescription(String description) {
        this.description = description;
    }
    public double getTargetAmount() {
        return targetAmount;
    }
    public void setTargetAmount(double targetAmount) {
        this.targetAmount = targetAmount;
    }
    public double getDiscountAmount() {
        return discountAmount;
    }
    public void setDiscountAmount(double discountAmount) {
        this.discountAmount = discountAmount;
    }
    public double calculateAmount(double payment) {
        return (int) (payment / this.getTargetAmount()) * this.getDiscountAmount()
                + payment;
    }
    public VIPCardStrategyVO getVO() {
        VIPCardStrategyVO vipCardStrategy = new VIPCardStrategyVO();
        vipCardStrategy.setId(this.getId());
        vipCardStrategy.setPrice(this.getPrice());
        vipCardStrategy.setDescription(this.getDescription());
        vipCardStrategy.setTargetAmount(this.getTargetAmount());
        vipCardStrategy.setDiscountAmount(this.getDiscountAmount());
        return vipCardStrategy;
    }
    public String toString() {
        return this.getId() + " "
                + this.getPrice() + " "
                + this.getDescription() + " "
                + this.getTargetAmount() + " "
                + this.getDiscountAmount() + " "
                + this.getDiscountAmount();
    }
}
```

###### 6.1.2.2 VIPCardCharge对象的定义
持久化用户对象VIPCardCharge的定义如下：
```java
public class VIPCardCharge {
    private int id;
    private int vipCardId;
    private Timestamp time;
    private double payment;
    private double amount;

    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }
    public int getVipCardId() {
        return vipCardId;
    }
    public void setVipCardId(int vipCardId) {
        this.vipCardId = vipCardId;
    }
    public Timestamp getTime() {
        return time;
    }
    public void setTime(Timestamp time) {
        this.time = time;
    }
    public double getPayment() {
        return payment;
    }
    public void setPayment(double payment) {
        this.payment = payment;
    }
    public double getAmount() {
        return amount;
    }
    public void setAmount(double amount) {
        this.amount = amount;
    }
}
```

###### 6.1.2.2 Consumption对象的定义

持久化用户对象Consumption的定义如下：

```
public class Consumption {
    private int userId;
    private double amount;

    public int getUserId() {
        return userId;
    }

    public void setUserId(int userId) {
        this.userId = userId;
    }

    public double getAmount() {
        return amount;
    }

    public void setAmount(double amount) {
        this.amount = amount;
    }
}

```



###### 6.1.2.3 Coupon对象的定义

持久化用户对象Coupon的定义如下：

```
public class Coupon {
    private int id;
    private String description;
    private String name;
    private double targetAmount;
    private double discountAmount;
    private Timestamp startTime;
    private Timestamp endTime;

    public Timestamp getStartTime() {
        return startTime;
    }

    public void setStartTime(Timestamp startTime) {
        this.startTime = startTime;
    }

    public Timestamp getEndTime() {
        return endTime;
    }

    public void setEndTime(Timestamp endTime) {
        this.endTime = endTime;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public double getTargetAmount() {
        return targetAmount;
    }

    public void setTargetAmount(double targetAmount) {
        this.targetAmount = targetAmount;
    }

    public double getDiscountAmount() {
        return discountAmount;
    }

    public void setDiscountAmount(double discountAmount) {
        this.discountAmount = discountAmount;
    }
}

```



###### 6.1.2.4 Ticket对象的定义

持久化用户对象Ticket的定义如下：

```
public class Ticket {

	private int orderId;
	private int id;
    private int userId;
    private int scheduleId;
    private int columnIndex;
    private int rowIndex;
    private int state;
    private double actualPayment;
    private Timestamp time;

    public int getOrderId() {
        return orderId;
    }

    public void setOrderId(int orderId) {
        this.orderId = orderId;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public int getUserId() {
        return userId;
    }

    public void setUserId(int userId) {
        this.userId = userId;
    }

    public int getScheduleId() {
        return scheduleId;
    }

    public void setScheduleId(int scheduleId) {
        this.scheduleId = scheduleId;
    }

    public int getColumnIndex() {
        return columnIndex;
    }

    public void setColumnIndex(int columnIndex) {
        this.columnIndex = columnIndex;
    }

    public int getRowIndex() {
        return rowIndex;
    }

    public void setRowIndex(int rowIndex) {
        this.rowIndex = rowIndex;
    }

    public double getActualPayment() {
        return actualPayment;
    }

    public void setActualPayment(double actualPayment) {
        this.actualPayment = actualPayment;
    }

    public int getState() {
        return state;
    }

    public String getStateString() {
        String stateString;
        switch (this.getState()) {
            case 0:
                stateString = "支付未完成";
                break;
            case 1:
                stateString = "支付已完成";
                break;
            case 2:
                stateString = "已失效";
                break;
            case 3:
                stateString = "已出票";
                break;
            case 4:
                stateString = "已退票";
                break;
            default:
                stateString = "支付未完成";
        }
        return stateString;
    }

    public void setState(int state) {
        this.state = state;
    }

    public Timestamp getTime() {
        return time;
    }

    public void setTime(Timestamp time) {
        this.time = time;
    }

    public TicketVO getVO() {
        TicketVO vo = new TicketVO();
        vo.setRowIndex(this.getRowIndex());
        vo.setColumnIndex(this.getColumnIndex());
        vo.setScheduleId(this.getScheduleId());
        vo.setId(this.getId());
        vo.setOrderId(this.getOrderId());
        vo.setUserId(this.getUserId());
        vo.setState(this.getStateString());
        vo.setActualPayment(this.getActualPayment());
        vo.setTime(this.getTime());
        return vo;
    }

    public SeatVO getSeatVO() {
        SeatVO vo = new SeatVO();
        vo.setId(this.getId());
        vo.setColumnIndex(this.getColumnIndex());
        vo.setRowIndex(this.getRowIndex());
        vo.setState(this.getStateString());
        vo.setActualPayment(this.getActualPayment());
        return vo;
    }

    public TicketWithScheduleVO getWithScheduleVO() {
        TicketWithScheduleVO vo = new TicketWithScheduleVO();
        vo.setRowIndex(this.getRowIndex());
        vo.setColumnIndex(this.getColumnIndex());
        vo.setOrderId(this.getOrderId());
        vo.setId(this.getId());
        vo.setUserId(this.getUserId());
        // 需要设置ScheduleItem
        vo.setState(this.getStateString());
        vo.setActualPayment(this.getActualPayment());
        vo.setTime(this.getTime());
        return vo;
    }

    public static List<TicketVO> ticketList2TicketVOList(List<Ticket> ticketList) {
        List<TicketVO> res = new ArrayList<>();
        for(Ticket ticket : ticketList) {
            res.add(ticket.getVO());
        }
        return res;
    }
}

```




###### 6.1.2.2 HallPO对象的定义


###### 6.1.2.2 HallPO对象的定义


###### 6.1.2.2 HallPO对象的定义

#### 6.2 数据库表
	数据库中包含activity表、activity_movie表、coupon表、coupon_user表、hall表、movie表、movie_like表、order表、refund_strategy表、refund_strategy_movie表、schedule表、ticket表、user表、view表、vip_card表、vip_card_charge表、vip_card_strategy表。
